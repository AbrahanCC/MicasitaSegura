<!DOCTYPE html>
<html>
<body>
  <h3>Emitir Pase</h3>
  <form id="emitForm">
    <label>Nombre:</label>
    <input name="nombre"><br>

    <label>Email:</label>
    <input name="email" type="email" required><br>

    <label>Motivo (solo visitante):</label>
    <input name="motivo"><br>

    <label>Destino (casa):</label>
    <input name="destino" required><br>

    <label>Tipo:</label>
    <select name="tipo">
      <option value="visitante">Visitante</option>
      <option value="residente">Residente</option>
    </select><br><br>

    <button type="submit">Emitir</button>
  </form>

  <h4>Respuesta:</h4>
  <pre id="result"></pre>

  <script>
    document.getElementById('emitForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = new FormData(e.target);
      const tipo = form.get('tipo');

      // elegimos endpoint seg√∫n el tipo
      const endpoint = tipo === 'visitante' ? 'api/emit' : 'api/emit-residente';

      // armamos el body para enviar
      let body = '';
      if (tipo === 'visitante') {
        body = 'nombre=' + encodeURIComponent(form.get('nombre'))
             + '&email=' + encodeURIComponent(form.get('email'))
             + '&motivo=' + encodeURIComponent(form.get('motivo'))
             + '&destino=' + encodeURIComponent(form.get('destino'));
      } else {
        // residente: solo necesitamos email (o usuarioId)
        body = 'correo=' + encodeURIComponent(form.get('email'));
      }

      const resp = await fetch(endpoint, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: body
      });

      const json = await resp.json();
      document.getElementById('result').textContent = JSON.stringify(json, null, 2);
    });
  </script>
</body>
</html>
